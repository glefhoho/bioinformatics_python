#	Program
#				This script filters low q of fastq file
# History
# 2022/7/15				GLEF				1st Ver

import getopt
import sys
from Bio import SeqIO

options, arguments = getopt.getopt(sys.argv[1:], '-h-f:-q:', ['help', 'file=', 'q_value='])

for opt_name, opt_value in options:
	if opt_name in ('-h', '--help'):
		print ('Need your input as: -f means input of fastq file name, -q means q_value of your threshoold')
		sys.exit()
	if opt_name in ('-f'):
		file_name = opt_value
	if opt_name in ('-q'):
		q_value = opt_value
	
for sequence in SeqIO.parse(file_name, "fq"):
	print('>'+sequence.id)
	L = []
	for i in range (0, len(sequence)):
		if sequence.letter_annotations['phred_quality'][i] < int (q_value):
			L.append('N')
		else:
			L.append(sequence.seq[i])
		
		new_seq = ''.join(L)
		
		print(new_seq)
